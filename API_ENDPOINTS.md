# API Endpoints - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –ø—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –ë–∞–∑–æ–≤—ã–π URL
```
http://localhost:8000
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- Swagger UI: `http://localhost:8000/docs`
- ReDoc: `http://localhost:8000/redoc`

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É `/api/auth`

### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**POST** `/api/auth/register`

–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "username": "string",  // 3-50 —Å–∏–º–≤–æ–ª–æ–≤, —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ
  "email": "string",     // –≤–∞–ª–∏–¥–Ω—ã–π email –∞–¥—Ä–µ—Å
  "password": "string"   // –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤, –º–∞–∫—Å–∏–º—É–º 72 –±–∞–π—Ç–∞ –≤ UTF-8
}
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (curl):**
```bash
curl -X 'POST' \
  'http://localhost:8000/api/auth/register' \
  -H 'Content-Type: application/json' \
  -d '{
    "username": "testuser",
    "email": "test@example.com",
    "password": "securepass123"
  }'
```

**–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (201 Created):**
```json
{
  "username": "testuser",
  "email": "test@example.com",
  "id": 1,
  "is_active": true,
  "created_at": "2024-01-15T10:30:00"
}
```

**–ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫:**
- `400 Bad Request` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º username –∏–ª–∏ email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- `422 Unprocessable Entity` - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

---

### 2. –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É (–ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞)

**POST** `/api/auth/login`

–ü–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

**–§–æ—Ä–º–∞—Ç:** `application/x-www-form-urlencoded` (OAuth2)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `username`: –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `password`: –ø–∞—Ä–æ–ª—å

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (curl):**
```bash
curl -X 'POST' \
  'http://localhost:8000/api/auth/login' \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  -d 'username=testuser&password=securepass123'
```

**–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (200 OK):**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer"
}
```

**–ü—Ä–∏–º–µ—Ä –æ—à–∏–±–∫–∏:**
- `401 Unauthorized` - –ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:**
–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization`:
```
Authorization: Bearer <access_token>
```

---

## üì® –°–æ–æ–±—â–µ–Ω–∏—è

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É `/api/messages`

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization)

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**GET** `/api/messages`

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `skip` (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0)
- `limit` (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π (1-100, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 50)
- `unread_only` (bool, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –ø–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: false)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (curl):**
```bash
curl -X 'GET' \
  'http://localhost:8000/api/messages?skip=0&limit=10&unread_only=false' \
  -H 'Authorization: Bearer YOUR_ACCESS_TOKEN'
```

**–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (200 OK):**
```json
[
  {
    "id": 1,
    "sender_id": 2,
    "recipient_id": 1,
    "subject": "–ü—Ä–∏–≤–µ—Ç!",
    "body": "–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ",
    "is_read": false,
    "is_deleted_by_sender": false,
    "is_deleted_by_recipient": false,
    "created_at": "2024-01-15T10:30:00",
    "read_at": null,
    "attachments": []
  }
]
```

---

### 4. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**GET** `/api/messages/sent`

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `skip` (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0)
- `limit` (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π (1-100, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 50)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (curl):**
```bash
curl -X 'GET' \
  'http://localhost:8000/api/messages/sent?skip=0&limit=20' \
  -H 'Authorization: Bearer YOUR_ACCESS_TOKEN'
```

**–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (200 OK):**
```json
[
  {
    "id": 1,
    "sender_id": 1,
    "recipient_id": 2,
    "subject": "–û—Ç–≤–µ—Ç –Ω–∞ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ",
    "body": "–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–∏—Å—å–º–æ!",
    "is_read": true,
    "is_deleted_by_sender": false,
    "is_deleted_by_recipient": false,
    "created_at": "2024-01-15T11:00:00",
    "read_at": "2024-01-15T11:05:00",
    "attachments": []
  }
]
```

---

### 5. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

**GET** `/api/messages/{message_id}`

–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –ø–æ ID.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏:**
- `message_id` (int): ID —Å–æ–æ–±—â–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (curl):**
```bash
curl -X 'GET' \
  'http://localhost:8000/api/messages/1' \
  -H 'Authorization: Bearer YOUR_ACCESS_TOKEN'
```

**–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (200 OK):**
```json
{
  "id": 1,
  "sender_id": 2,
  "recipient_id": 1,
  "subject": "–í–∞–∂–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ",
  "body": "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∑–¥–µ—Å—å",
  "is_read": false,
  "is_deleted_by_sender": false,
  "is_deleted_by_recipient": false,
  "created_at": "2024-01-15T10:30:00",
  "read_at": null,
  "attachments": [
    {
      "id": 1,
      "attachment_type": "item",
      "item_id": 123,
      "item_name": "–ú–µ—á –≤–æ–∏–Ω–∞",
      "quantity": "1.0",
      "attachment_data": {
        "rarity": "epic",
        "level": 10
      }
    }
  ]
}
```

**–ü—Ä–∏–º–µ—Ä –æ—à–∏–±–∫–∏:**
- `404 Not Found` - –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### 6. –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

**POST** `/api/messages`

–°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥—Ä—É–≥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "recipient_id": 2,                    // ID –ø–æ–ª—É—á–∞—Ç–µ–ª—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  "subject": "string",                  // –¢–µ–º–∞ (1-200 —Å–∏–º–≤–æ–ª–æ–≤, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  "body": "string",                     // –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  "attachments": [                      // –í–ª–æ–∂–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    {
      "attachment_type": "item",        // –¢–∏–ø: "item", "currency", "gold" –∏ —Ç.–¥.
      "item_id": 123,                   // ID –ø—Ä–µ–¥–º–µ—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
      "item_name": "–ú–µ—á –≤–æ–∏–Ω–∞",         // –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
      "quantity": "1.0",                // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1.0)
      "attachment_data": {              // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        "rarity": "epic",
        "level": 10
      }
    }
  ]
}
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (curl):**
```bash
curl -X 'POST' \
  'http://localhost:8000/api/messages' \
  -H 'Authorization: Bearer YOUR_ACCESS_TOKEN' \
  -H 'Content-Type: application/json' \
  -d '{
    "recipient_id": 2,
    "subject": "–ü—Ä–∏–≤–µ—Ç –æ—Ç –∏–≥—Ä–æ–∫–∞!",
    "body": "–•–æ—á—É –æ–±–º–µ–Ω—è—Ç—å—Å—è –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏. –ì–æ—Ç–æ–≤ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –º–µ—á –∑–∞ 100 –∑–æ–ª–æ—Ç–∞.",
    "attachments": [
      {
        "attachment_type": "item",
        "item_id": 123,
        "item_name": "–ú–µ—á –≤–æ–∏–Ω–∞",
        "quantity": "1.0",
        "attachment_data": {
          "rarity": "epic",
          "level": 10
        }
      },
      {
        "attachment_type": "gold",
        "quantity": "100.0"
      }
    ]
  }'
```

**–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (201 Created):**
```json
{
  "id": 5,
  "sender_id": 1,
  "recipient_id": 2,
  "subject": "–ü—Ä–∏–≤–µ—Ç –æ—Ç –∏–≥—Ä–æ–∫–∞!",
  "body": "–•–æ—á—É –æ–±–º–µ–Ω—è—Ç—å—Å—è –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏. –ì–æ—Ç–æ–≤ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –º–µ—á –∑–∞ 100 –∑–æ–ª–æ—Ç–∞.",
  "is_read": false,
  "is_deleted_by_sender": false,
  "is_deleted_by_recipient": false,
  "created_at": "2024-01-15T12:00:00",
  "read_at": null,
  "attachments": [
    {
      "id": 1,
      "attachment_type": "item",
      "item_id": 123,
      "item_name": "–ú–µ—á –≤–æ–∏–Ω–∞",
      "quantity": "1.0",
      "attachment_data": {
        "rarity": "epic",
        "level": 10
      }
    },
    {
      "id": 2,
      "attachment_type": "gold",
      "item_id": null,
      "item_name": null,
      "quantity": "100.0",
      "attachment_data": null
    }
  ]
}
```

---

### 7. –û—Ç–º–µ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–≥–æ

**PATCH** `/api/messages/{message_id}/read`

–û—Ç–º–µ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–≥–æ. –¢–æ–ª—å–∫–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏:**
- `message_id` (int): ID —Å–æ–æ–±—â–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (curl):**
```bash
curl -X 'PATCH' \
  'http://localhost:8000/api/messages/1/read' \
  -H 'Authorization: Bearer YOUR_ACCESS_TOKEN'
```

**–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (200 OK):**
```json
{
  "id": 1,
  "sender_id": 2,
  "recipient_id": 1,
  "subject": "–í–∞–∂–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ",
  "body": "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è",
  "is_read": true,
  "is_deleted_by_sender": false,
  "is_deleted_by_recipient": false,
  "created_at": "2024-01-15T10:30:00",
  "read_at": "2024-01-15T12:00:00",
  "attachments": []
}
```

---

### 8. –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**DELETE** `/api/messages/{message_id}`

–ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è. –°–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç —Å–∫—Ä—ã—Ç–æ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–æ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–ª—è –¥—Ä—É–≥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –ø–µ—Ä–µ–ø–∏—Å–∫–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏:**
- `message_id` (int): ID —Å–æ–æ–±—â–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (curl):**
```bash
curl -X 'DELETE' \
  'http://localhost:8000/api/messages/1' \
  -H 'Authorization: Bearer YOUR_ACCESS_TOKEN'
```

**–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (204 No Content):**
(—Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)

---

## üè† –°–∏—Å—Ç–µ–º–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### 9. –ö–æ—Ä–Ω–µ–≤–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç

**GET** `/`

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± API.

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (curl):**
```bash
curl -X 'GET' 'http://localhost:8000/'
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (200 OK):**
```json
{
  "message": "Game Mail API",
  "version": "1.0.0",
  "docs": "/docs"
}
```

---

### 10. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è

**GET** `/health`

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ API.

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (curl):**
```bash
curl -X 'GET' 'http://localhost:8000/health'
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (200 OK):**
```json
{
  "status": "healthy"
}
```

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 1:
```json
{
  "username": "player1",
  "email": "player1@game.com",
  "password": "password123"
}
```

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 2:
```json
{
  "username": "player2",
  "email": "player2@game.com",
  "password": "password456"
}
```

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 3:
```json
{
  "username": "trader",
  "email": "trader@game.com",
  "password": "trader789"
}
```

### –ü—Ä–∏–º–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π

#### –ü—Ä–æ—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:
```json
{
  "recipient_id": 2,
  "subject": "–ü—Ä–∏–≤–µ—Ç!",
  "body": "–ö–∞–∫ –¥–µ–ª–∞? –•–æ—á–µ—à—å —Å—ã–≥—Ä–∞—Ç—å –≤–º–µ—Å—Ç–µ?"
}
```

#### –°–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–µ–¥–º–µ—Ç–æ–º:
```json
{
  "recipient_id": 2,
  "subject": "–û–±–º–µ–Ω –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏",
  "body": "–ü—Ä–µ–¥–ª–∞–≥–∞—é –æ–±–º–µ–Ω—è—Ç—å –º–æ–π –º–µ—á –Ω–∞ —Ç–≤–æ–π —â–∏—Ç.",
  "attachments": [
    {
      "attachment_type": "item",
      "item_id": 101,
      "item_name": "–ú–µ—á –¥—Ä–∞–∫–æ–Ω–∞",
      "quantity": "1.0",
      "attachment_data": {
        "rarity": "legendary",
        "level": 50,
        "damage": 150
      }
    }
  ]
}
```

#### –°–æ–æ–±—â–µ–Ω–∏–µ —Å –≤–∞–ª—é—Ç–æ–π:
```json
{
  "recipient_id": 3,
  "subject": "–û–ø–ª–∞—Ç–∞ –∑–∞ —É—Å–ª—É–≥–∏",
  "body": "–ü–µ—Ä–µ–≤–æ–∂—É –æ–ø–ª–∞—Ç—É –∑–∞ –ø–æ–º–æ—â—å –≤ –∫–≤–µ—Å—Ç–µ.",
  "attachments": [
    {
      "attachment_type": "gold",
      "quantity": "500.0"
    },
    {
      "attachment_type": "currency",
      "item_name": "–ö—Ä–∏—Å—Ç–∞–ª–ª—ã",
      "quantity": "10.0"
    }
  ]
}
```

#### –°–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤–ª–æ–∂–µ–Ω–∏—è–º–∏:
```json
{
  "recipient_id": 2,
  "subject": "–ü–æ–¥–∞—Ä–æ–∫",
  "body": "–î–µ—Ä–∂–∏ –ø–æ–¥–∞—Ä–æ–∫! –ù–∞–¥–µ—é—Å—å, –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è.",
  "attachments": [
    {
      "attachment_type": "item",
      "item_id": 205,
      "item_name": "–ó–µ–ª—å–µ –ª–µ—á–µ–Ω–∏—è",
      "quantity": "5.0",
      "attachment_data": {
        "type": "consumable",
        "effect": "heal",
        "value": 100
      }
    },
    {
      "attachment_type": "item",
      "item_id": 150,
      "item_name": "–≠–ª–∏–∫—Å–∏—Ä –æ–ø—ã—Ç–∞",
      "quantity": "2.0"
    },
    {
      "attachment_type": "gold",
      "quantity": "1000.0"
    }
  ]
}
```

---

## üîÑ –ü–æ–ª–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X 'POST' \
  'http://localhost:8000/api/auth/register' \
  -H 'Content-Type: application/json' \
  -d '{
    "username": "player1",
    "email": "player1@game.com",
    "password": "password123"
  }'
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –æ—Ç–≤–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `id: 1`)**

### –®–∞–≥ 2: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Ç–æ—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X 'POST' \
  'http://localhost:8000/api/auth/register' \
  -H 'Content-Type: application/json' \
  -d '{
    "username": "player2",
    "email": "player2@game.com",
    "password": "password456"
  }'
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –æ—Ç–≤–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `id: 2`)**

### –®–∞–≥ 3: –í—Ö–æ–¥ –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X 'POST' \
  'http://localhost:8000/api/auth/login' \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  -d 'username=player1&password=password123'
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ `access_token` –∏–∑ –æ—Ç–≤–µ—Ç–∞ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `TOKEN1`**

### –®–∞–≥ 4: –í—Ö–æ–¥ –≤—Ç–æ—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X 'POST' \
  'http://localhost:8000/api/auth/login' \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  -d 'username=player2&password=password456'
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ `access_token` –∏–∑ –æ—Ç–≤–µ—Ç–∞ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `TOKEN2`**

### –®–∞–≥ 5: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç player1 –∫ player2
```bash
curl -X 'POST' \
  'http://localhost:8000/api/messages' \
  -H "Authorization: Bearer $TOKEN1" \
  -H 'Content-Type: application/json' \
  -d '{
    "recipient_id": 2,
    "subject": "–ü—Ä–∏–≤–µ—Ç!",
    "body": "–•–æ—á–µ—à—å –æ–±–º–µ–Ω—è—Ç—å—Å—è –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏?",
    "attachments": [
      {
        "attachment_type": "item",
        "item_id": 123,
        "item_name": "–ú–µ—á –≤–æ–∏–Ω–∞",
        "quantity": "1.0"
      }
    ]
  }'
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ ID —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –æ—Ç–≤–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `id: 1`)**

### –®–∞–≥ 6: –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π player2
```bash
curl -X 'GET' \
  'http://localhost:8000/api/messages?unread_only=true' \
  -H "Authorization: Bearer $TOKEN2"
```

### –®–∞–≥ 7: –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è player2
```bash
curl -X 'GET' \
  'http://localhost:8000/api/messages/1' \
  -H "Authorization: Bearer $TOKEN2"
```

### –®–∞–≥ 8: –û—Ç–º–µ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–≥–æ
```bash
curl -X 'PATCH' \
  'http://localhost:8000/api/messages/1/read' \
  -H "Authorization: Bearer $TOKEN2"
```

### –®–∞–≥ 9: –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π player1
```bash
curl -X 'GET' \
  'http://localhost:8000/api/messages/sent' \
  -H "Authorization: Bearer $TOKEN1"
```

### –®–∞–≥ 10: –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
```bash
curl -X 'DELETE' \
  'http://localhost:8000/api/messages/1' \
  -H "Authorization: Bearer $TOKEN2"
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è**: 
   - –ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤
   - –ú–∞–∫—Å–∏–º—É–º 72 –±–∞–π—Ç–∞ –≤ UTF-8 –∫–æ–¥–∏—Ä–æ–≤–∫–µ
   - –°–∏–º–≤–æ–ª—ã Unicode (–Ω–∞–ø—Ä–∏–º–µ—Ä, —ç–º–æ–¥–∑–∏) –º–æ–≥—É—Ç –∑–∞–Ω–∏–º–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–∞–π—Ç

3. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–º—ã —Å–æ–æ–±—â–µ–Ω–∏—è**: 1-200 —Å–∏–º–≤–æ–ª–æ–≤

4. **–ü–∞–≥–∏–Ω–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `skip` –∏ `limit` –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ —Å–ø–∏—Å–∫–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π

5. **–ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ**: –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –¥—Ä—É–≥–æ–π —É—á–∞—Å—Ç–Ω–∏–∫ –ø–µ—Ä–µ–ø–∏—Å–∫–∏ –≤—Å–µ –µ—â–µ –º–æ–∂–µ—Ç –µ–≥–æ –≤–∏–¥–µ—Ç—å

6. **–¢–æ–∫–µ–Ω—ã**: JWT —Ç–æ–∫–µ–Ω—ã –∏–º–µ—é—Ç —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30 –º–∏–Ω—É—Ç). –ü–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ

---

## üêõ –ö–æ–¥—ã –æ—à–∏–±–æ–∫

- `200 OK` - –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- `201 Created` - –†–µ—Å—É—Ä—Å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω
- `204 No Content` - –£—Å–ø–µ—à–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (—Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
- `400 Bad Request` - –ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- `401 Unauthorized` - –¢—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `403 Forbidden` - –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω
- `404 Not Found` - –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- `422 Unprocessable Entity` - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- `500 Internal Server Error` - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

